<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Ausgewählte nichtlineare Schätzverfahren | R für die sozio-ökonomische Forschung</title>
  <meta name="description" content="Einführung in R für die sozioökonomische Forschung; Version 1.0.0" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Ausgewählte nichtlineare Schätzverfahren | R für die sozio-ökonomische Forschung" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Einführung in R für die sozioökonomische Forschung; Version 1.0.0" />
  <meta name="github-repo" content="graebnerc/RforSocioEcon" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Ausgewählte nichtlineare Schätzverfahren | R für die sozio-ökonomische Forschung" />
  
  <meta name="twitter:description" content="Einführung in R für die sozioökonomische Forschung; Version 1.0.0" />
  

<meta name="author" content="Dr. Claudius Gräbner" />


<meta name="date" content="2020-09-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="advlin.html"/>

<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R für die sozioökonomische Forschung</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Willkommen</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#danksagung"><i class="fa fa-check"></i>Danksagung</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#lizenz"><i class="fa fa-check"></i>Lizenz</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#änderungshistorie"><i class="fa fa-check"></i>Änderungshistorie</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="precons.html"><a href="precons.html"><i class="fa fa-check"></i><b>1</b> Vorbemerkungen</a>
<ul>
<li class="chapter" data-level="1.1" data-path="precons.html"><a href="precons.html#warum-r"><i class="fa fa-check"></i><b>1.1</b> Warum R?</a></li>
<li class="chapter" data-level="1.2" data-path="precons.html"><a href="precons.html#besonderheiten-von-r"><i class="fa fa-check"></i><b>1.2</b> Besonderheiten von R</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="einrichtung.html"><a href="einrichtung.html"><i class="fa fa-check"></i><b>2</b> Einrichtung</a>
<ul>
<li class="chapter" data-level="2.1" data-path="einrichtung.html"><a href="einrichtung.html#installation-von-r-und-r-studio"><i class="fa fa-check"></i><b>2.1</b> Installation von R und R-Studio</a></li>
<li class="chapter" data-level="2.2" data-path="einrichtung.html"><a href="einrichtung.html#die-r-studio-oberfläche"><i class="fa fa-check"></i><b>2.2</b> Die R Studio Oberfläche</a></li>
<li class="chapter" data-level="2.3" data-path="einrichtung.html"><a href="einrichtung.html#einrichtung-eines-r-projekts"><i class="fa fa-check"></i><b>2.3</b> Einrichtung eines R Projekts</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="einrichtung.html"><a href="einrichtung.html#arbeitsverzeichnisse-und-pfade"><i class="fa fa-check"></i><b>2.3.1</b> Arbeitsverzeichnisse und Pfade</a></li>
<li class="chapter" data-level="2.3.2" data-path="einrichtung.html"><a href="einrichtung.html#schritt-1-projektordner-anlegen"><i class="fa fa-check"></i><b>2.3.2</b> Schritt 1: Projektordner anlegen</a></li>
<li class="chapter" data-level="2.3.3" data-path="einrichtung.html"><a href="einrichtung.html#schritt-2-ein-r-studio-projekt-im-projektordner-erstellen"><i class="fa fa-check"></i><b>2.3.3</b> Schritt 2: Ein R-Studio Projekt im Projektordner erstellen</a></li>
<li class="chapter" data-level="2.3.4" data-path="einrichtung.html"><a href="einrichtung.html#unterordner"><i class="fa fa-check"></i><b>2.3.4</b> Schritt 3: Relevante Unterordner erstellen</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="einrichtung.html"><a href="einrichtung.html#optional-schritt-4-und-das-here-paket"><i class="fa fa-check"></i><b>2.4</b> Optional: Schritt 4 und das here-Paket</a></li>
<li class="chapter" data-level="2.5" data-path="einrichtung.html"><a href="einrichtung.html#abschließende-bemerkungen"><i class="fa fa-check"></i><b>2.5</b> Abschließende Bemerkungen</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>3</b> Erste Schritte in R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="basics.html"><a href="basics.html#es:befehle"><i class="fa fa-check"></i><b>3.1</b> Befehle in R an den Computer übermitteln</a></li>
<li class="chapter" data-level="3.2" data-path="basics.html"><a href="basics.html#es:objekte"><i class="fa fa-check"></i><b>3.2</b> Objekte, Funktionen und Zuweisungen</a></li>
<li class="chapter" data-level="3.3" data-path="basics.html"><a href="basics.html#es:objektarten"><i class="fa fa-check"></i><b>3.3</b> Grundlegende Objeke in R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="basics.html"><a href="basics.html#funktionen"><i class="fa fa-check"></i><b>3.3.1</b> Funktionen</a></li>
<li class="chapter" data-level="3.3.2" data-path="basics.html"><a href="basics.html#basics-types-vectors"><i class="fa fa-check"></i><b>3.3.2</b> Vektoren</a></li>
<li class="chapter" data-level="3.3.3" data-path="basics.html"><a href="basics.html#basics-logic"><i class="fa fa-check"></i><b>3.3.3</b> Logische Werte (logical)</a></li>
<li class="chapter" data-level="3.3.4" data-path="basics.html"><a href="basics.html#wörter-character"><i class="fa fa-check"></i><b>3.3.4</b> Wörter (character)</a></li>
<li class="chapter" data-level="3.3.5" data-path="basics.html"><a href="basics.html#fehlende-werte-und-null"><i class="fa fa-check"></i><b>3.3.5</b> Fehlende Werte und NULL</a></li>
<li class="chapter" data-level="3.3.6" data-path="basics.html"><a href="basics.html#indizierung-und-ersetzung"><i class="fa fa-check"></i><b>3.3.6</b> Indizierung und Ersetzung</a></li>
<li class="chapter" data-level="3.3.7" data-path="basics.html"><a href="basics.html#nützliche-funktionen-für-atomare-vektoren"><i class="fa fa-check"></i><b>3.3.7</b> Nützliche Funktionen für atomare Vektoren</a></li>
<li class="chapter" data-level="3.3.8" data-path="basics.html"><a href="basics.html#listen"><i class="fa fa-check"></i><b>3.3.8</b> Listen</a></li>
<li class="chapter" data-level="3.3.9" data-path="basics.html"><a href="basics.html#introfactors"><i class="fa fa-check"></i><b>3.3.9</b> Faktoren</a></li>
<li class="chapter" data-level="3.3.10" data-path="basics.html"><a href="basics.html#intro-matrix"><i class="fa fa-check"></i><b>3.3.10</b> Matrizen</a></li>
<li class="chapter" data-level="3.3.11" data-path="basics.html"><a href="basics.html#data-frames"><i class="fa fa-check"></i><b>3.3.11</b> Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="basics.html"><a href="basics.html#es:pakete"><i class="fa fa-check"></i><b>3.4</b> Pakete</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>4</b> Datenkunde und Datenaufbereitung</a>
<ul>
<li class="chapter" data-level="" data-path="data.html"><a href="data.html#verwendete-pakete"><i class="fa fa-check"></i>Verwendete Pakete</a></li>
<li class="chapter" data-level="4.1" data-path="data.html"><a href="data.html#data-arten"><i class="fa fa-check"></i><b>4.1</b> Arten von Daten</a></li>
<li class="chapter" data-level="4.2" data-path="data.html"><a href="data.html#data-get"><i class="fa fa-check"></i><b>4.2</b> Datenakquise</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data.html"><a href="data.html#exkurs-1-ländercodes-übersetzen"><i class="fa fa-check"></i><b>4.2.1</b> Exkurs 1: Ländercodes übersetzen</a></li>
<li class="chapter" data-level="4.2.2" data-path="data.html"><a href="data.html#data-download-R"><i class="fa fa-check"></i><b>4.2.2</b> Exkurs 2: Daten direkt mit R herunterladen</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data.html"><a href="data.html#data-read-write"><i class="fa fa-check"></i><b>4.3</b> Daten einlesen und schreiben</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data.html"><a href="data.html#einlesen-von-datensätzen"><i class="fa fa-check"></i><b>4.3.1</b> Einlesen von Datensätzen</a></li>
<li class="chapter" data-level="4.3.2" data-path="data.html"><a href="data.html#speichern-von-daten"><i class="fa fa-check"></i><b>4.3.2</b> Speichern von Daten</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data.html"><a href="data.html#data-wrangling"><i class="fa fa-check"></i><b>4.4</b> Verarbeitung von Daten (‘data wrangling’)</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="data.html"><a href="data.html#das-konzept-von-tidy-data"><i class="fa fa-check"></i><b>4.4.1</b> Das Konzept von ‘tidy data’</a></li>
<li class="chapter" data-level="4.4.2" data-path="data.html"><a href="data.html#data-long-wide"><i class="fa fa-check"></i><b>4.4.2</b> Von langen und breiten Datensätzen</a></li>
<li class="chapter" data-level="4.4.3" data-path="data.html"><a href="data.html#data-merge"><i class="fa fa-check"></i><b>4.4.3</b> Zusammenführen von Daten</a></li>
<li class="chapter" data-level="4.4.4" data-path="data.html"><a href="data.html#date-select"><i class="fa fa-check"></i><b>4.4.4</b> Datensätze filtern und selektieren</a></li>
<li class="chapter" data-level="4.4.5" data-path="data.html"><a href="data.html#data-summary"><i class="fa fa-check"></i><b>4.4.5</b> Datensätze zusammenfassen</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data.html"><a href="data.html#data-role"><i class="fa fa-check"></i><b>4.5</b> Abschließende Bemerkungen zum Umgang mit Daten innerhalb eines Forschungsprojekts</a></li>
<li class="chapter" data-level="4.6" data-path="data.html"><a href="data.html#data-packages"><i class="fa fa-check"></i><b>4.6</b> Anmerkungen zu Paketen</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="linmodel.html"><a href="linmodel.html"><i class="fa fa-check"></i><b>5</b> Lineare statistische Modelle in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="linmodel.html"><a href="linmodel.html#einleitung-und-überblick"><i class="fa fa-check"></i><b>5.1</b> Einleitung und Überblick</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="linmodel.html"><a href="linmodel.html#einführung-in-die-lineare-regression"><i class="fa fa-check"></i><b>5.1.1</b> Einführung in die lineare Regression</a></li>
<li class="chapter" data-level="5.1.2" data-path="linmodel.html"><a href="linmodel.html#einführungsbeispiel"><i class="fa fa-check"></i><b>5.1.2</b> Einführungsbeispiel</a></li>
<li class="chapter" data-level="5.1.3" data-path="linmodel.html"><a href="linmodel.html#überblick-über-die-inhalte-des-kapitels"><i class="fa fa-check"></i><b>5.1.3</b> Überblick über die Inhalte des Kapitels</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="linmodel.html"><a href="linmodel.html#lin-grundlagen"><i class="fa fa-check"></i><b>5.2</b> Grundlagen der einfachen linearen Regression</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="linmodel.html"><a href="linmodel.html#grundlegende-begriffe"><i class="fa fa-check"></i><b>5.2.1</b> Grundlegende Begriffe</a></li>
<li class="chapter" data-level="5.2.2" data-path="linmodel.html"><a href="linmodel.html#schätzung-mit-der-kleinste-quadrate-methode"><i class="fa fa-check"></i><b>5.2.2</b> Schätzung mit der Kleinste-Quadrate-Methode</a></li>
<li class="chapter" data-level="5.2.3" data-path="linmodel.html"><a href="linmodel.html#ols-ass"><i class="fa fa-check"></i><b>5.2.3</b> Annahmen für den OLS Schätzer</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="linmodel.html"><a href="linmodel.html#lin-kennzahlen"><i class="fa fa-check"></i><b>5.3</b> Kennzahlen in der linearen Regression</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="linmodel.html"><a href="linmodel.html#erklärte-varianz-und-das-r2"><i class="fa fa-check"></i><b>5.3.1</b> Erklärte Varianz und das <span class="math inline">\(R^2\)</span></a></li>
<li class="chapter" data-level="5.3.2" data-path="linmodel.html"><a href="linmodel.html#hypothesentests-und-statistische-signifikanz"><i class="fa fa-check"></i><b>5.3.2</b> Hypothesentests und statistische Signifikanz</a></li>
<li class="chapter" data-level="5.3.3" data-path="linmodel.html"><a href="linmodel.html#konfidenzintervalle-für-die-schätzer"><i class="fa fa-check"></i><b>5.3.3</b> Konfidenzintervalle für die Schätzer</a></li>
<li class="chapter" data-level="5.3.4" data-path="linmodel.html"><a href="linmodel.html#zur-rolle-der-stichprobengröße"><i class="fa fa-check"></i><b>5.3.4</b> Zur Rolle der Stichprobengröße</a></li>
<li class="chapter" data-level="5.3.5" data-path="linmodel.html"><a href="linmodel.html#linmod-residuals"><i class="fa fa-check"></i><b>5.3.5</b> Residuenanalyse</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="linmodel.html"><a href="linmodel.html#stat-ablauf"><i class="fa fa-check"></i><b>5.4</b> Zum Ablauf einer Regression</a></li>
<li class="chapter" data-level="5.5" data-path="linmodel.html"><a href="linmodel.html#lin-multi"><i class="fa fa-check"></i><b>5.5</b> Multiple lineare Regression</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="advlin.html"><a href="advlin.html"><i class="fa fa-check"></i><b>6</b> Fortgeschrittene Themen der linearen Regression</a>
<ul>
<li class="chapter" data-level="6.1" data-path="advlin.html"><a href="advlin.html#annahmen-und-eigenschaften-des-einfachen-ols-modells"><i class="fa fa-check"></i><b>6.1</b> Annahmen und Eigenschaften des einfachen OLS Modells</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="advlin.html"><a href="advlin.html#annahmen-im-matrixschreibweise"><i class="fa fa-check"></i><b>6.1.1</b> Annahmen im Matrixschreibweise</a></li>
<li class="chapter" data-level="6.1.2" data-path="advlin.html"><a href="advlin.html#erwartungstreue-effizienz-und-konsistenz"><i class="fa fa-check"></i><b>6.1.2</b> Erwartungstreue, Effizienz und Konsistenz</a></li>
<li class="chapter" data-level="6.1.3" data-path="advlin.html"><a href="advlin.html#abweichungen-von-den-ols-annahmen"><i class="fa fa-check"></i><b>6.1.3</b> Abweichungen von den OLS Annahmen</a></li>
<li class="chapter" data-level="6.1.4" data-path="advlin.html"><a href="advlin.html#monte-carlo-simulationen-in-r"><i class="fa fa-check"></i><b>6.1.4</b> Monte Carlo Simulationen in R</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="advlin.html"><a href="advlin.html#heteroskedastie"><i class="fa fa-check"></i><b>6.2</b> Heteroskedastie</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="advlin.html"><a href="advlin.html#liegt-heteroskedastie-vor"><i class="fa fa-check"></i><b>6.2.1</b> Liegt Heteroskedastie vor?</a></li>
<li class="chapter" data-level="6.2.2" data-path="advlin.html"><a href="advlin.html#reaktionen-auf-heteroskedastie"><i class="fa fa-check"></i><b>6.2.2</b> Reaktionen auf Heteroskedastie</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="advlin.html"><a href="advlin.html#autokorrelation"><i class="fa fa-check"></i><b>6.3</b> Autokorrelation</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="advlin.html"><a href="advlin.html#folgen-von-autokorrelation"><i class="fa fa-check"></i><b>6.3.1</b> Folgen von Autokorrelation</a></li>
<li class="chapter" data-level="6.3.2" data-path="advlin.html"><a href="advlin.html#testen-auf-autokorrelation"><i class="fa fa-check"></i><b>6.3.2</b> Testen auf Autokorrelation</a></li>
<li class="chapter" data-level="6.3.3" data-path="advlin.html"><a href="advlin.html#reaktionen-auf-autokorrelation"><i class="fa fa-check"></i><b>6.3.3</b> Reaktionen auf Autokorrelation</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="advlin.html"><a href="advlin.html#multikollinearität"><i class="fa fa-check"></i><b>6.4</b> Multikollinearität</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="advlin.html"><a href="advlin.html#folgen-von-multikollinearität"><i class="fa fa-check"></i><b>6.4.1</b> Folgen von Multikollinearität</a></li>
<li class="chapter" data-level="6.4.2" data-path="advlin.html"><a href="advlin.html#testen-auf-multikollinearität"><i class="fa fa-check"></i><b>6.4.2</b> Testen auf Multikollinearität</a></li>
<li class="chapter" data-level="6.4.3" data-path="advlin.html"><a href="advlin.html#reaktionen-auf-multikollinearität"><i class="fa fa-check"></i><b>6.4.3</b> Reaktionen auf Multikollinearität</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="advlin.html"><a href="advlin.html#advlin-omitted-var"><i class="fa fa-check"></i><b>6.5</b> Vergessene Variablen</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="advlin.html"><a href="advlin.html#folgen-vergessener-variablen"><i class="fa fa-check"></i><b>6.5.1</b> Folgen vergessener Variablen</a></li>
<li class="chapter" data-level="6.5.2" data-path="advlin.html"><a href="advlin.html#testen-auf-vergessene-variablen"><i class="fa fa-check"></i><b>6.5.2</b> Testen auf vergessene Variablen</a></li>
<li class="chapter" data-level="6.5.3" data-path="advlin.html"><a href="advlin.html#reaktion-auf-vergessene-variablen"><i class="fa fa-check"></i><b>6.5.3</b> Reaktion auf vergessene Variablen</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="advlin.html"><a href="advlin.html#falsche-funktionale-form"><i class="fa fa-check"></i><b>6.6</b> Falsche funktionale Form</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="advlin.html"><a href="advlin.html#folgen-einer-falschen-funktionalen-form"><i class="fa fa-check"></i><b>6.6.1</b> Folgen einer falschen funktionalen Form</a></li>
<li class="chapter" data-level="6.6.2" data-path="advlin.html"><a href="advlin.html#testen-auf-die-richtige-funktionale-form"><i class="fa fa-check"></i><b>6.6.2</b> Testen auf die richtige funktionale Form</a></li>
<li class="chapter" data-level="6.6.3" data-path="advlin.html"><a href="advlin.html#wahl-der-funktionalen-form"><i class="fa fa-check"></i><b>6.6.3</b> Wahl der funktionalen Form</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="advlin.html"><a href="advlin.html#weitere-fehlerquellen-systematische-messfehler-selbstselektion-und-simulatanität"><i class="fa fa-check"></i><b>6.7</b> Weitere Fehlerquellen: Systematische Messfehler, Selbstselektion und Simulatanität</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="advlin.html"><a href="advlin.html#messfehler"><i class="fa fa-check"></i><b>6.7.1</b> Messfehler</a></li>
<li class="chapter" data-level="6.7.2" data-path="advlin.html"><a href="advlin.html#selbstselektion"><i class="fa fa-check"></i><b>6.7.2</b> Selbstselektion</a></li>
<li class="chapter" data-level="6.7.3" data-path="advlin.html"><a href="advlin.html#simulatanität"><i class="fa fa-check"></i><b>6.7.3</b> Simulatanität</a></li>
</ul></li>
<li class="chapter" data-level="6.8" data-path="advlin.html"><a href="advlin.html#anhang-übersicht-über-die-testverfahren"><i class="fa fa-check"></i><b>6.8</b> Anhang: Übersicht über die Testverfahren</a></li>
<li class="chapter" data-level="6.9" data-path="advlin.html"><a href="advlin.html#advlin-proofs"><i class="fa fa-check"></i><b>6.9</b> Anhang: Relevante Theoreme und ihre mathematischen Beweise</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="advlin.html"><a href="advlin.html#theoreme"><i class="fa fa-check"></i><b>6.9.1</b> Theoreme</a></li>
<li class="chapter" data-level="6.9.2" data-path="advlin.html"><a href="advlin.html#beweise"><i class="fa fa-check"></i><b>6.9.2</b> Beweise</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="nonlin.html"><a href="nonlin.html"><i class="fa fa-check"></i><b>7</b> Ausgewählte nichtlineare Schätzverfahren</a>
<ul>
<li class="chapter" data-level="7.1" data-path="nonlin.html"><a href="nonlin.html#logit"><i class="fa fa-check"></i><b>7.1</b> Binäre abhängige Variablen: Logit- und Probit-Modelle</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="nonlin.html"><a href="nonlin.html#warum-nicht-ols"><i class="fa fa-check"></i><b>7.1.1</b> Warum nicht OLS?</a></li>
<li class="chapter" data-level="7.1.2" data-path="nonlin.html"><a href="nonlin.html#logit-und-probit-theoretische-grundidee"><i class="fa fa-check"></i><b>7.1.2</b> Logit und Probit: theoretische Grundidee</a></li>
<li class="chapter" data-level="7.1.3" data-path="nonlin.html"><a href="nonlin.html#logit-und-probit-implementierung-in-r"><i class="fa fa-check"></i><b>7.1.3</b> Logit und Probit: Implementierung in R</a></li>
<li class="chapter" data-level="7.1.4" data-path="nonlin.html"><a href="nonlin.html#logit-und-probit-interpretation-der-ergebnisse"><i class="fa fa-check"></i><b>7.1.4</b> Logit und Probit: Interpretation der Ergebnisse</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R für die sozio-ökonomische Forschung</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="nonlin" class="section level1" number="7">
<h1><span class="header-section-number">Chapter 7</span> Ausgewählte nichtlineare Schätzverfahren</h1>
<p>Eine der zentralsten und gleichzeitig restriktivsten Annahmen des
OLS Modells ist die Annahme eines linearen Zusammenhangs zwischen der
abhängigen und den unabhängigen Variablen.
Auch wenn wir im letzten Kapitel gesehen haben wie wir manche nicht-lineare
Zusammenhänge durch angemessene Datentransformationen und der Verwendung
cleverer funktionaler Formen mit OLS konsistent schätzen können bleiben
zahlreiche interessante Zusammenhänge außen vor.</p>
<p>In diesem Kapitel werden wir uns beispielhaft mit dem Fall beschäftigen, in
dem unsere abhängige Variable binär ist.
Ein typisches Beispiel ist die Analyse von Arbeitslosigkeit.
Stellen wir uns vor wir möchten untersuchen unter welchen Umständen Menschen
arbeitslos werden.
Unsere abhängige Variable <span class="math inline">\(\boldsymbol{y}\)</span> ist dabei eine binäre Varianble, die
entweder den Wert <span class="math inline">\(0\)</span> annimmt wenn eine Person nicht arbeitslos ist oder den
Wert <span class="math inline">\(1\)</span> annimmt wenn eine Person arbeitslos ist.
Unsere Matrix <span class="math inline">\(\boldsymbol{X}\)</span> enthält dann Informationen über Variablen, die
die Arbeitslosigkeit beeinfluss könnten, z.B. Ausbildungsniveau oder Alter.
Wir möchten untersuchen wie Variation in den erklärenden Variablen die
Wahrscheinlichkeit bestimmt, dass jemand arbeitslos ist, also
<span class="math inline">\(\mathbb{P}(\boldsymbol{y}=\boldsymbol{1} | \boldsymbol{X})\)</span>.</p>
<p>Dieser Zusammenhang kann unmöglich als linear aufgefasst werden:
es ist unmöglich, dass <span class="math inline">\(y&lt;0\)</span> oder <span class="math inline">\(y&gt;1\)</span> und der Zusammenhang im Intervall
<span class="math inline">\([0,1]\)</span> ist quasi nie linear.
Daher ist der herkömmliche OLS Schätzer für solche Fälle ungeeignet, denn A1 ist
klar verletzt.
In diesem Kapitel lernen wir dabei logit- und probit-Modelle als alternative
Schätzverfahren kennen.</p>
<p>Dabei werden die folgenden Pakete verwendet:</p>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="nonlin.html#cb579-1" aria-hidden="true"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb579-2"><a href="nonlin.html#cb579-2" aria-hidden="true"></a><span class="kw">library</span>(data.table)</span>
<span id="cb579-3"><a href="nonlin.html#cb579-3" aria-hidden="true"></a><span class="kw">library</span>(here)</span>
<span id="cb579-4"><a href="nonlin.html#cb579-4" aria-hidden="true"></a><span class="kw">library</span>(icaeDesign)</span></code></pre></div>
<div id="logit" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Binäre abhängige Variablen: Logit- und Probit-Modelle</h2>
<p>Das folgende Beispiel verwendet angepasste Daten aus <span class="citation">Kleiber and Zeileis (<a href="#ref-AER" role="doc-biblioref">2008</a>)</span> zur
Beschäftigunssituation von Frauen aus der Schweiz:</p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="nonlin.html#cb580-1" aria-hidden="true"></a>schweiz_al &lt;-<span class="st"> </span><span class="kw">fread</span>(<span class="kw">here</span>(<span class="st">&quot;data/tidy/nonlinmodels_schweizer-arbeit.csv&quot;</span>), </span>
<span id="cb580-2"><a href="nonlin.html#cb580-2" aria-hidden="true"></a>                    <span class="dt">colClasses =</span> <span class="kw">c</span>(<span class="st">&quot;double&quot;</span>, <span class="kw">rep</span>(<span class="st">&quot;double&quot;</span>, <span class="dv">5</span>), <span class="st">&quot;factor&quot;</span>))</span>
<span id="cb580-3"><a href="nonlin.html#cb580-3" aria-hidden="true"></a><span class="kw">head</span>(schweiz_al)</span></code></pre></div>
<pre><code>#&gt;    Arbeitslos Einkommen_log Alter Ausbildung_Jahre Kinder_jung Kinder_alt
#&gt; 1:          1      10.78750    30                8           1          1
#&gt; 2:          0      10.52425    45                8           0          1
#&gt; 3:          1      10.96858    46                9           0          0
#&gt; 4:          1      11.10500    31               11           2          0
#&gt; 5:          1      11.10847    44               12           0          2
#&gt; 6:          0      11.02825    42               12           0          1
#&gt;    Auslaender
#&gt; 1:          0
#&gt; 2:          0
#&gt; 3:          0
#&gt; 4:          0
#&gt; 5:          0
#&gt; 6:          0</code></pre>
<p>Wir sind interessiert welchen Einfluss die erklärenden Variablen auf die
Wahrscheinlichkeit haben, dass eine Frau Arbeitslos ist, also die Variable
<code>Arbeitslos</code> den Wert <code>1</code> annimmt.</p>
<div id="warum-nicht-ols" class="section level3" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Warum nicht OLS?</h3>
<p>Wir könnten natürlich zunächst einmal unser bekanntes und geliebtes OLS Modell
verwenden um den Zusammenhang zu schätzen.
Um die Probleme zu illustrieren schätzen wir einmal nur den bivariaten
Zusammenhang zwischen <code>Arbeitslos</code> und <code>Einkommen_log</code>:</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="nonlin.html#cb582-1" aria-hidden="true"></a><span class="kw">ggplot</span>(</span>
<span id="cb582-2"><a href="nonlin.html#cb582-2" aria-hidden="true"></a>  <span class="dt">data =</span> schweiz_al,</span>
<span id="cb582-3"><a href="nonlin.html#cb582-3" aria-hidden="true"></a>  <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>Einkommen_log, <span class="dt">y=</span>Arbeitslos, <span class="dt">group=</span><span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb582-4"><a href="nonlin.html#cb582-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">14</span>)) <span class="op">+</span></span>
<span id="cb582-5"><a href="nonlin.html#cb582-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Arbeitslosigkeit&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Arbeitsunabh. Einkommen (log)&quot;</span>) <span class="op">+</span></span>
<span id="cb582-6"><a href="nonlin.html#cb582-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">fullrange=</span><span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_icae</span>()</span></code></pre></div>
<pre><code>#&gt; `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Chap-nonlinmodels-binary_files/figure-html/unnamed-chunk-5-1.png" width="75%" height="75%" style="display: block; margin: auto;" /></p>
<p>Unser Modell würde für bestimmte Levels an arbeitsunabhängigem Einkommen
Werte außerhalb des Intervalls <span class="math inline">\(0, 1\)</span> vorhersagen - also Werte, die <span class="math inline">\(y\)</span> gar nicht
annehmen kann und die, da wir die Werte für <span class="math inline">\(y\)</span> später als Wahrscheinlichkeiten
interpretieren wollen, auch gar keinen Sinn ergeben wollen.</p>
<p>Unser Ziel ist da eher ein funktionaler Zusammenhang wie in folgender
Abbildung zu sehen:</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="nonlin.html#cb584-1" aria-hidden="true"></a><span class="kw">ggplot</span>(</span>
<span id="cb584-2"><a href="nonlin.html#cb584-2" aria-hidden="true"></a>  <span class="dt">data =</span> schweiz_al,</span>
<span id="cb584-3"><a href="nonlin.html#cb584-3" aria-hidden="true"></a>  <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x=</span>Einkommen_log, <span class="dt">y=</span>Arbeitslos, <span class="dt">group=</span><span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb584-4"><a href="nonlin.html#cb584-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">7</span>, <span class="dv">14</span>)) <span class="op">+</span></span>
<span id="cb584-5"><a href="nonlin.html#cb584-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Arbeitslosigkeit&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Arbeitsunabh. Einkommen (log)&quot;</span>) <span class="op">+</span></span>
<span id="cb584-6"><a href="nonlin.html#cb584-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="kw">aes</span>(<span class="dt">y=</span>Arbeitslos), <span class="dt">method =</span> <span class="st">&quot;glm&quot;</span>,</span>
<span id="cb584-7"><a href="nonlin.html#cb584-7" aria-hidden="true"></a>                             <span class="dt">method.args =</span> <span class="kw">list</span>(<span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>), </span>
<span id="cb584-8"><a href="nonlin.html#cb584-8" aria-hidden="true"></a>                             <span class="dt">fullrange=</span><span class="ot">TRUE</span>, <span class="dt">se =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_icae</span>()</span></code></pre></div>
<pre><code>#&gt; `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Chap-nonlinmodels-binary_files/figure-html/unnamed-chunk-6-1.png" width="75%" height="75%" style="display: block; margin: auto;" /></p>
<p>Dieser Zusammenhang ist jedoch nicht linear und damit inkonsisten mit A1 des
OLS Modells.</p>
</div>
<div id="logit-und-probit-theoretische-grundidee" class="section level3" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Logit und Probit: theoretische Grundidee</h3>
<p>Wir sind interessiert an <span class="math inline">\(\mathbb{P}(y=1|\boldsymbol{x})\)</span>, also der
Wahrscheinlichkeit, dass <span class="math inline">\(y\)</span> den Wert <span class="math inline">\(1\)</span> annimmt, gegeben die unabhängigen
Variablen <span class="math inline">\(\boldsymbol{x}\)</span>.</p>
<p>Eine Möglichkeit <span class="math inline">\(\mathbb{P}(y=1|\boldsymbol{x})\)</span> auf das Intervall <span class="math inline">\([0,1]\)</span> zu
beschränken ist folgende Transformation:</p>
<p><span class="math display">\[\mathbb{P}(y=1|\boldsymbol{x})=\frac{\exp(\boldsymbol{X\beta})}{1+\exp(\boldsymbol{X\beta})}\]</span>
Diesen Ausdruck können wir dann folgendermaßen umformen:</p>
<p><span class="math display">\[\frac{\mathbb{P}(y=1|\boldsymbol{x})}{1-\mathbb{P}(y=1|\boldsymbol{x})}=\frac{\frac{\exp(\boldsymbol{X\beta})}{1+\exp(\boldsymbol{X\beta})}}{1-\frac{\exp(\boldsymbol{X\beta})}{1+\exp(\boldsymbol{X\beta})}}\]</span>
Hier haben wir nun die so genannten <em>odds</em>:
das Verhältnist dass <span class="math inline">\(\mathbb{P}(y=1|\boldsymbol{x})\)</span> und
<span class="math inline">\(\mathbb{P}(y\neq0|\boldsymbol{x})\)</span>.
Wir multiplizieren nun den linken Teil der Gleichung mit
<span class="math inline">\(1=\frac{\exp(\boldsymbol{X\beta})}{\exp(\boldsymbol{X\beta})}\)</span> um den
Zähler durch Kürzen zu vereinfachen:</p>
<p><span class="math display">\[\begin{align}
\frac{\mathbb{P}(y=1|\boldsymbol{x})}{1-\mathbb{P}(y=1|\boldsymbol{x})} &amp;=
\frac{\exp(\boldsymbol{X\beta})}{\exp(\boldsymbol{X\beta})\cdot
\left(\frac{1+\exp(\boldsymbol{X\beta}}{1+\exp(\boldsymbol{X\beta}}-
\frac{\exp(\boldsymbol{X\beta})}{1+\exp(\boldsymbol{X\beta})}\right)}\nonumber\\
&amp;=
\frac{\exp(\boldsymbol{X\beta})}{\left(1+\exp(\boldsymbol{X\beta})\right)\cdot
\frac{1}{1+\exp(\boldsymbol{X\beta})}}\nonumber\\
&amp;=\exp(\boldsymbol{X\beta})
\end{align}\]</span></p>
<p>Nun können wir durch logarithmieren eine brauchbare Schätzgleichung herleiten:</p>
<p><span class="math display">\[\begin{align}
\ln\left(\frac{\mathbb{P}(y=1|\boldsymbol{x})}{1-\mathbb{P}(y=1|\boldsymbol{x})}\right) 
&amp;= \ln\left(\exp(\boldsymbol{X\beta})\right)\nonumber\\ 
\ln\left(\frac{\mathbb{P}(y=1|\boldsymbol{x})}{1-\mathbb{P}(y=1|\boldsymbol{x})}\right)  
&amp;= \boldsymbol{X\beta}
\end{align}\]</span></p>
<p>Wir sprechen hier von dem so genannten <em>logit</em> Modell, da wir hier auf der
linken Seite den <em>Logarithmus</em> der <em>Odds</em> haben.
Diesen Zusammenhang können wir nun auch ohne Probleme mit unserem OLS-Schätzer
schätzen, denn hier haben wir einen klaren linearen Zusammenhang.
Nur die anhängige Variable ist auf den ersten Blick ein wenig merkwürdig:
der logarithmus der <em>Odds</em> des interessierenden Events.
Aber das ist kein unlösbares Problem wie wir später sehen werden.</p>
<p><em>probit</em> Modelle funktionieren auf eine sehr ähnliche Art und Weise, verwenden
aber eine andere Transformation über die kumulierte Wahrscheinlichkeitsverteilung
der Normalverteilung.
Hier wird im Endeffekt folgende Regressionsgleichung geschätzt:</p>
<p><span class="math display">\[\mathbb{P}(y=1|\boldsymbol{x})=\phi(\boldsymbol{X\beta})\]</span></p>
<p>wobei <span class="math inline">\(\Phi(\cdot)\)</span> die kumulierte Wahrscheinlichkeitsverteilung der
Normalverteilung ist.
Wie sie in folgender Abbildung sehen, die sich wieder auf das
Einführungsbeispiel bezieht, sind die funktionalen Formen bei der
beiden Modelle sehr ähnlich:</p>
<pre><code>#&gt; `geom_smooth()` using formula &#39;y ~ x&#39;
#&gt; `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="Chap-nonlinmodels-binary_files/figure-html/unnamed-chunk-7-1.png" width="75%" height="75%" style="display: block; margin: auto;" /></p>
<p>Wir werden der Einfachheit halber im folgenden in der Regel das
<em>logit</em> Modell verwenden, aber die Implementierung in R ist wirklich sehr ähnlich.</p>
</div>
<div id="logit-und-probit-implementierung-in-r" class="section level3" number="7.1.3">
<h3><span class="header-section-number">7.1.3</span> Logit und Probit: Implementierung in R</h3>
<p>Da <em>logit</em> und <em>probit</em> Modell zu den so genannten <em>generalisierten Modellen</em>
gehören verwenden wir die Funktion <code>glm</code> um die Modelle zu schätzen.
Die Spezifikation ist dabei sehr ähnlich zu den linearen Modellen, die wir
mit <code>lm()</code> geschätzt haben.</p>
<p>Nehmen wir einmal an wir wollen mit unserem Datensatz von Schweizerinnen
die Effekt von Alter und arbeitsunabhänigem Einkommen auf die Wahrscheinlichkeit
der Arbeitslosigkeit schätzen.</p>
<p>Als erstes Argument <code>formula</code> übergeben wir wieder die Schätzgleichung.
In unserem Falle wäre das also <code>Arbeitslos ~ Alter + Einkommen_log</code>.</p>
<p>Als zweites Argument (<code>family</code>) müssen wir die Schätzart spezifizieren.
Für <em>logit</em> Modelle schreiben wir <code>family = binomial(link = "logit")</code>, für
<em>probit</em> Modelle entsprechend <code>family = binomial(link = "probit")</code>.</p>
<p>Das letzte Argument ist dann <code>data</code>.
Insgesamt erhalten wir also für das <em>logit</em>-Modell:</p>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="nonlin.html#cb587-1" aria-hidden="true"></a>arbeitslogit_test &lt;-<span class="st"> </span><span class="kw">glm</span>(</span>
<span id="cb587-2"><a href="nonlin.html#cb587-2" aria-hidden="true"></a>  Arbeitslos <span class="op">~</span><span class="st"> </span>Einkommen_log <span class="op">+</span><span class="st"> </span>Alter, </span>
<span id="cb587-3"><a href="nonlin.html#cb587-3" aria-hidden="true"></a>  <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>), </span>
<span id="cb587-4"><a href="nonlin.html#cb587-4" aria-hidden="true"></a>  <span class="dt">data =</span> schweiz_al)</span></code></pre></div>
<p>Und das <em>probit</em>-Modell:</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="nonlin.html#cb588-1" aria-hidden="true"></a>arbeitsprobit_test &lt;-<span class="st"> </span><span class="kw">glm</span>(</span>
<span id="cb588-2"><a href="nonlin.html#cb588-2" aria-hidden="true"></a>  Arbeitslos <span class="op">~</span><span class="st"> </span>Einkommen_log <span class="op">+</span><span class="st"> </span>Alter, </span>
<span id="cb588-3"><a href="nonlin.html#cb588-3" aria-hidden="true"></a>  <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;probit&quot;</span>), </span>
<span id="cb588-4"><a href="nonlin.html#cb588-4" aria-hidden="true"></a>  <span class="dt">data =</span> schweiz_al)</span></code></pre></div>
<p>Für die Schätzergebnisse können wir wie bilang die Funktion <code>summary()</code>
verwenden:</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="nonlin.html#cb589-1" aria-hidden="true"></a><span class="kw">summary</span>(arbeitslogit_test)</span></code></pre></div>
<pre><code>#&gt; 
#&gt; Call:
#&gt; glm(formula = Arbeitslos ~ Einkommen_log + Alter, family = binomial(link = &quot;logit&quot;), 
#&gt;     data = schweiz_al)
#&gt; 
#&gt; Deviance Residuals: 
#&gt;     Min       1Q   Median       3Q      Max  
#&gt; -1.7448  -1.1855   0.8128   1.1017   1.8279  
#&gt; 
#&gt; Coefficients:
#&gt;                 Estimate Std. Error z value Pr(&gt;|z|)    
#&gt; (Intercept)   -10.381739   2.003223  -5.183 2.19e-07 ***
#&gt; Einkommen_log   0.920045   0.185414   4.962 6.97e-07 ***
#&gt; Alter           0.018013   0.006612   2.724  0.00645 ** 
#&gt; ---
#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
#&gt; 
#&gt; (Dispersion parameter for binomial family taken to be 1)
#&gt; 
#&gt;     Null deviance: 1203.2  on 871  degrees of freedom
#&gt; Residual deviance: 1168.5  on 869  degrees of freedom
#&gt; AIC: 1174.5
#&gt; 
#&gt; Number of Fisher Scoring iterations: 4</code></pre>
<p>Aber wie sollen wir das interpretieren?
Da das ein wenig schwieriger ist beschäftigen wir uns damit im nächsten
Abschnitt.</p>
</div>
<div id="logit-und-probit-interpretation-der-ergebnisse" class="section level3" number="7.1.4">
<h3><span class="header-section-number">7.1.4</span> Logit und Probit: Interpretation der Ergebnisse</h3>
<p>Wie wir oben gesehen haben ist die abhängige Variable in der Logit-Regression
der Logarithmus der <em>Odds Ratio</em>.
Das ist nicht ganz einfach zu interpretieren.
So bedeutet der Koeffizient für <code>Auslaender1</code> in folgender Ergebnistabelle,
dass sich die logarithmierte <em>Odds Ratio</em> <em>ceteris paribus</em> um 1.3 Prozent
reduziert, wenn die betroffene Person Ausländerin ist:</p>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="nonlin.html#cb591-1" aria-hidden="true"></a>arbeitslogit &lt;-<span class="st"> </span><span class="kw">glm</span>(</span>
<span id="cb591-2"><a href="nonlin.html#cb591-2" aria-hidden="true"></a>  Arbeitslos <span class="op">~</span><span class="st"> </span>Einkommen_log <span class="op">+</span><span class="st"> </span>Alter <span class="op">+</span><span class="st"> </span>Ausbildung_Jahre <span class="op">+</span><span class="st"> </span>Kinder_jung <span class="op">+</span><span class="st"> </span></span>
<span id="cb591-3"><a href="nonlin.html#cb591-3" aria-hidden="true"></a><span class="st">    </span>Kinder_alt <span class="op">+</span><span class="st"> </span>Auslaender, </span>
<span id="cb591-4"><a href="nonlin.html#cb591-4" aria-hidden="true"></a>  <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> <span class="st">&quot;logit&quot;</span>), </span>
<span id="cb591-5"><a href="nonlin.html#cb591-5" aria-hidden="true"></a>  <span class="dt">data =</span> schweiz_al)</span>
<span id="cb591-6"><a href="nonlin.html#cb591-6" aria-hidden="true"></a><span class="kw">summary</span>(arbeitslogit)</span></code></pre></div>
<pre><code>#&gt; 
#&gt; Call:
#&gt; glm(formula = Arbeitslos ~ Einkommen_log + Alter + Ausbildung_Jahre + 
#&gt;     Kinder_jung + Kinder_alt + Auslaender, family = binomial(link = &quot;logit&quot;), 
#&gt;     data = schweiz_al)
#&gt; 
#&gt; Deviance Residuals: 
#&gt;     Min       1Q   Median       3Q      Max  
#&gt; -2.2681  -1.0675   0.5383   0.9727   1.9384  
#&gt; 
#&gt; Coefficients:
#&gt;                    Estimate Std. Error z value Pr(&gt;|z|)    
#&gt; (Intercept)      -10.374346   2.166852  -4.788 1.69e-06 ***
#&gt; Einkommen_log      0.815041   0.205501   3.966 7.31e-05 ***
#&gt; Alter              0.051033   0.009052   5.638 1.72e-08 ***
#&gt; Ausbildung_Jahre  -0.031728   0.029036  -1.093    0.275    
#&gt; Kinder_jung        1.330724   0.180170   7.386 1.51e-13 ***
#&gt; Kinder_alt         0.021986   0.073766   0.298    0.766    
#&gt; Auslaender1       -1.310405   0.199758  -6.560 5.38e-11 ***
#&gt; ---
#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
#&gt; 
#&gt; (Dispersion parameter for binomial family taken to be 1)
#&gt; 
#&gt;     Null deviance: 1203.2  on 871  degrees of freedom
#&gt; Residual deviance: 1052.8  on 865  degrees of freedom
#&gt; AIC: 1066.8
#&gt; 
#&gt; Number of Fisher Scoring iterations: 4</code></pre>
<p>Es wäre ja deutlich schöner wenn wir Änderungen in den unabhängigen Variablen
als Änderungen in <span class="math inline">\(\mathbb{P}(y=1|\boldsymbol{x})\)</span> interpretieren könnten.
In unserem Beispiel also: um wie viel Prozent würde die Wahrscheinlichkeit für
Arbeitslosigkeit steigen wenn es sich bei der betroffenen Person um eine
Ausländerin handelt?
Um dieses Ergebnis zu bekommen bedarf es aber einiger weniger Umformungen.</p>
<p>Da der Zusammenhang zwischen <span class="math inline">\(\mathbb{P}(y=1|\boldsymbol{x})\)</span> und den
unabhängigen Variablen nicht-linear ist müssen wir für die Vergleiche der
Wahrscheinlichkeiten konkrete Werte angeben.</p>
<p>In einem ersten Schritt verwenden wir die Funktion <code>predict</code>, der wir als
erstes Argument <code>object</code> unser geschätztes Modell übergeben.
Als zweites Argument übergeben wir einen <code>data.frame</code>, in dem wir die
relevanten Änderungen und den zu betrachtenden Bereich angeben.
Je nach Anzahl der abhängigen Variablen kann diese Tabelle recht groß werden,
sie ist aber notwendig, da der Zusammenhang zwischen abhängigen und unabhängiger
Variable ja nicht-linear ist.</p>
<p>Als drittes Argument müssen wir noch <code>type = "response"</code> übergeben damit
wir die Vorhersagen auf der Skala der zugrundeliegenden abhänigigen Variable
bekommen, also direkt als Wahrscheinlichkeiten:</p>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="nonlin.html#cb593-1" aria-hidden="true"></a>predicted_probs &lt;-<span class="st"> </span><span class="kw">predict</span>(<span class="dt">object =</span> arbeitslogit, </span>
<span id="cb593-2"><a href="nonlin.html#cb593-2" aria-hidden="true"></a>        <span class="dt">newdata =</span> <span class="kw">data.frame</span>(</span>
<span id="cb593-3"><a href="nonlin.html#cb593-3" aria-hidden="true"></a>          <span class="st">&quot;Einkommen_log&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>), </span>
<span id="cb593-4"><a href="nonlin.html#cb593-4" aria-hidden="true"></a>          <span class="st">&quot;Alter&quot;</span>=<span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">30</span>), </span>
<span id="cb593-5"><a href="nonlin.html#cb593-5" aria-hidden="true"></a>          <span class="st">&quot;Ausbildung_Jahre&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">5</span>),</span>
<span id="cb593-6"><a href="nonlin.html#cb593-6" aria-hidden="true"></a>          <span class="st">&quot;Kinder_alt&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb593-7"><a href="nonlin.html#cb593-7" aria-hidden="true"></a>          <span class="st">&quot;Kinder_jung&quot;</span>=<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb593-8"><a href="nonlin.html#cb593-8" aria-hidden="true"></a>          <span class="st">&quot;Auslaender&quot;</span> =<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb593-9"><a href="nonlin.html#cb593-9" aria-hidden="true"></a>          ),</span>
<span id="cb593-10"><a href="nonlin.html#cb593-10" aria-hidden="true"></a>        <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb593-11"><a href="nonlin.html#cb593-11" aria-hidden="true"></a>predicted_probs</span></code></pre></div>
<pre><code>#&gt;         1         2 
#&gt; 0.6175431 0.8593445</code></pre>
<p>Das erste Element ist die Wahrscheinlichkeit arbeitslos zu sein für eine
dreißigjährige Frau mit einem
arbeitsunabhänigen Einkommen von <span class="math inline">\(\exp(10)=22025\)</span>, fünfjähiger Ausbildung, keinen
alten Kindern, einem jungen Kind und mit schweizerischer Staatsangehörigkeit.
Die zweite Wahrscheinlichkeit gilt für eine Frau mit den gleichen Eigenschaften
aber zwei jungen Kindern.
Mit <code>diff()</code> bekommen wir gleich den entsprechenden Effekt des zweiten jungen
Kindes auf die Wahrscheinlichkeit arbeitslos zu sein:</p>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="nonlin.html#cb595-1" aria-hidden="true"></a><span class="kw">diff</span>(predicted_probs)</span></code></pre></div>
<pre><code>#&gt;         2 
#&gt; 0.2418014</code></pre>
<p>Die Wahrscheinlichkeit ist also nach dem Modell ca. <span class="math inline">\(25\%\)</span> größer!
Wenn wir wissen wollen ob der Effekt für Ausländerinnen ähnlich ist rechnen wir:</p>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="nonlin.html#cb597-1" aria-hidden="true"></a><span class="kw">diff</span>(</span>
<span id="cb597-2"><a href="nonlin.html#cb597-2" aria-hidden="true"></a>  <span class="kw">predict</span>(<span class="dt">object =</span> arbeitslogit, </span>
<span id="cb597-3"><a href="nonlin.html#cb597-3" aria-hidden="true"></a>        <span class="dt">newdata =</span> <span class="kw">data.frame</span>(</span>
<span id="cb597-4"><a href="nonlin.html#cb597-4" aria-hidden="true"></a>          <span class="st">&quot;Einkommen_log&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>, <span class="dv">10</span>), </span>
<span id="cb597-5"><a href="nonlin.html#cb597-5" aria-hidden="true"></a>          <span class="st">&quot;Alter&quot;</span>=<span class="kw">c</span>(<span class="dv">30</span>, <span class="dv">30</span>), </span>
<span id="cb597-6"><a href="nonlin.html#cb597-6" aria-hidden="true"></a>          <span class="st">&quot;Ausbildung_Jahre&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">5</span>),</span>
<span id="cb597-7"><a href="nonlin.html#cb597-7" aria-hidden="true"></a>          <span class="st">&quot;Kinder_alt&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb597-8"><a href="nonlin.html#cb597-8" aria-hidden="true"></a>          <span class="st">&quot;Kinder_jung&quot;</span>=<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb597-9"><a href="nonlin.html#cb597-9" aria-hidden="true"></a>          <span class="st">&quot;Auslaender&quot;</span> =<span class="st"> </span><span class="kw">factor</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb597-10"><a href="nonlin.html#cb597-10" aria-hidden="true"></a>          ),</span>
<span id="cb597-11"><a href="nonlin.html#cb597-11" aria-hidden="true"></a>        <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb597-12"><a href="nonlin.html#cb597-12" aria-hidden="true"></a>)</span></code></pre></div>
<pre><code>#&gt;         2 
#&gt; 0.3189543</code></pre>
<p>Hier ist der Effekt mit ca. <span class="math inline">\(32\%\)</span> also noch größer!</p>


<div id="refs" class="references hanging-indent">
<div>
<p>Arel-Bundock, Vincent. 2019. <em>WDI: World Development Indicators (World Bank)</em>. <a href="https://CRAN.R-project.org/package=WDI">https://CRAN.R-project.org/package=WDI</a>.</p>
</div>
<div>
<p>Arel-Bundock, Vincent, Nils Enevoldsen, and CJ Yetman. 2018. “Countrycode: An R Package to Convert Country Names and Country Codes.” <em>Journal of Open Source Software</em> 3 (28): 848. <a href="https://doi.org/10.21105/joss.00848">https://doi.org/10.21105/joss.00848</a>.</p>
</div>
<div>
<p>Bengtsson, Henrik. 2019. <em>R.utils: Various Programming Utilities</em>. <a href="https://CRAN.R-project.org/package=R.utils">https://CRAN.R-project.org/package=R.utils</a>.</p>
</div>
<div>
<p>Dowle, Matt, and Arun Srinivasan. 2019. <em>Data.table: Extension of ‘Data.frame‘</em>. <a href="https://CRAN.R-project.org/package=data.table">https://CRAN.R-project.org/package=data.table</a>.</p>
</div>
<div>
<p>Epple, Dennis, and Bennett T. McCallum. 2006. “Simultaneous Equation Econometrics: The Missing Example.” <em>Economic Inquiry</em> 44 (2).</p>
</div>
<div>
<p>Greene, William H. 2018. <em>Econometric Analysis</em>. New York, NY: Pearson.</p>
</div>
<div>
<p>Heckman, James. 1979. “Sample Selection Bias as a Specification Error.” <em>Econometrica</em>. <a href="https://doi.org/doi:10.2307/1912352">https://doi.org/doi:10.2307/1912352</a>.</p>
</div>
<div>
<p>Herndon, Thomas, Michael Ash, and Robert Pollin. 2013. “Does high public debt consistently stifle economic growth? A critique of Reinhart and Rogoff.” <em>Cambridge Journal of Economics</em> 38 (2): 257–79. <a href="https://doi.org/10.1093/cje/bet075">https://doi.org/10.1093/cje/bet075</a>.</p>
</div>
<div>
<p>Kleiber, Christian, and Achim Zeileis. 2008. <em>Applied Econometrics with R</em>. New York: Springer-Verlag. <a href="https://CRAN.R-project.org/package=AER">https://CRAN.R-project.org/package=AER</a>.</p>
</div>
<div>
<p>Kuznets, Simon. 1934. <em>National Income, 1929-1932</em>. Washington D.C.: U.S. Government Printing Office. <a href="https://fraser.stlouisfed.org/title/971">https://fraser.stlouisfed.org/title/971</a>.</p>
</div>
<div>
<p>Lepenies, Philipp. 2016. <em>The Power of a Single Number</em>. New York, NY: Columbia University Press.</p>
</div>
<div>
<p>Müller, Kirill. 2017. <em>Here: A Simpler Way to Find Your Files</em>. <a href="https://CRAN.R-project.org/package=here">https://CRAN.R-project.org/package=here</a>.</p>
</div>
<div>
<p>R Core Team. 2018. <em>R: A Language and Environment for Statistical Computing</em>. Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.R-project.org/">https://www.R-project.org/</a>.</p>
</div>
<div>
<p>Venables, W. N., and B. D. Ripley. 2002. <em>Modern Applied Statistics with S</em>. Fourth. New York: Springer. <a href="http://www.stats.ox.ac.uk/pub/MASS4">http://www.stats.ox.ac.uk/pub/MASS4</a>.</p>
</div>
<div>
<p>Wickham, Hadley. 2014. “Tidy Data.” <em>The Journal of Statistical Software</em> 59 (10). <a href="https://doi.org/10.18637/jss.v059.i10">https://doi.org/10.18637/jss.v059.i10</a>.</p>
</div>
<div>
<p>———. 2019. <em>Advanced R</em>. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. <a href="https://adv-r.hadley.nz/">https://adv-r.hadley.nz/</a>.</p>
</div>
<div>
<p>Wickham, Hadley, and Jennifer Bryan. 2019. <em>Advanced R</em>. 2nd ed. Sebastopol, CA: O’Reilly Media. <a href="https://r-pkgs.org/">https://r-pkgs.org/</a>.</p>
</div>
<div>
<p>Wickham, Hadley, Romain François, Lionel Henry, and Kirill Müller. 2019. <em>Dplyr: A Grammar of Data Manipulation</em>. <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.</p>
</div>
<div>
<p>Wickham, Hadley, and Lionel Henry. 2019. <em>Tidyr: Tidy Messy Data</em>. <a href="https://CRAN.R-project.org/package=tidyr">https://CRAN.R-project.org/package=tidyr</a>.</p>
</div>
<div>
<p>Wickham, Hadley, and Evan Miller. 2019. <em>Haven: Import and Export ’Spss’, ’Stata’ and ’Sas’ Files</em>. <a href="https://CRAN.R-project.org/package=haven">https://CRAN.R-project.org/package=haven</a>.</p>
</div>
<div>
<p>Zeileis, Achim. 2004. “Econometric Computing with HC and HAC Covariance Matrix Estimators.” <em>Journal of Statistical Software</em> 11 (10): 1–17. <a href="https://doi.org/10.18637/jss.v011.i10">https://doi.org/10.18637/jss.v011.i10</a>.</p>
</div>
<div>
<p>Zeileis, Achim, and Torsten Hothorn. 2002. “Diagnostic Checking in Regression Relationships.” <em>R News</em> 2 (3): 7–10. <a href="https://CRAN.R-project.org/doc/Rnews/">https://CRAN.R-project.org/doc/Rnews/</a>.</p>
</div>
</div>
</div>
</div>
</div>


















































































































































































<h3>References</h3>
<div id="refs" class="references">
<div id="ref-AER">
<p>Kleiber, Christian, and Achim Zeileis. 2008. <em>Applied Econometrics with R</em>. New York: Springer-Verlag. <a href="https://CRAN.R-project.org/package=AER">https://CRAN.R-project.org/package=AER</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="advlin.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["R-SocioEcon-dt.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
